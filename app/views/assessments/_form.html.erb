<%= simple_form_for(@assessment, defaults: { input_html: { class: 'span8' } }) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <section id="title">
      <h1>Title</h1>

      <%= f.input :title, as: :string, label: 'Full name of the assessment' %>
      <%= f.input :short_title, label: 'Short name of the assessment (if applicable)' %>
    </section>
    <section id="geographical_coverage">
      <h1>Geographical coverage</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'geo_scale') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :select, label: 'Geographical scale of the assessment', collection: ['Global', 'Regional', 'Sub-regional', 'National', 'Sub-national', 'Set of sites', 'Single site'], input_html: { class: 'select2 span8' } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'geo_countries') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :select, label: 'Countries covered', collection: Country.all.map { |c| [c.name, c.id] }, input_html: { class: 'select_geo_countries span8', multiple: true }, selected: answer_object(@assessment, 'geo_countries').text_value.try(:split, ',') %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'geo_info') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Any other necessary information or explanation for identifying the location of the assessment, including site or region name', input_html: { rows: 10 } %>
      <% end %>
    </section>
    <section id="conceptual_framework">
      <h1>Conceptual framework, methodology and scope</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'objectives') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Assessment objectives', input_html: { rows: 10 } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'mandate') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Mandate for the assessment', input_html: { rows: 10 } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'conceptual_framework') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :radio_buttons, label: 'Conceptual framework and/or methodology used for the assessment', collection: ['Millennium Ecosystem Assessment (MA)', 'Global Environment Outlook (GEO)', 'The Economics of Ecosystems and Biodiversity (TEEB)', 'Other (please specify)'], input_html: { class: false } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'conceptual_framework_other') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :string, label: false %>
      <% end %>
      <h5>Attachments</h5>
      <div id="conceptual_framework_urls">
        <%= f.simple_fields_for :attachments, attachment_objects(@assessment, 'conceptual_framework_url') do |builder| %>
          <%= render 'nested_attachment_form', :f => builder %>
        <% end %>
      </div>
      <%= link_to_add_fields 'Add Attachment', f, :attachments, 'conceptual_framework_url', 'attachment' %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'conceptual_framework_url') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :string, label: 'URL or copy of conceptual framework developed or adapted' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'systems_assessed') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :check_boxes, label: 'System(s) assessed', collection: ['Marine', 'Coastal', 'Island', 'Inland water', 'Forest and woodland', 'Cultivated/Agricultural land', 'Grassland', 'Mountain', 'Dryland', 'Polar', 'Urban'], input_html: { class: false }, checked: answer_object(@assessment, 'systems_assessed').text_value.try(:split, ',') %>
      <% end %>

      <div id="systems_assessed_others">
        <%= f.simple_fields_for :answers, answer_objects(@assessment, 'systems_assessed_other') do |builder| %>
          <%= render 'nested_field_form', :f => builder %>
        <% end %>
      </div>

      <%= link_to_add_fields 'Add Answer', f, :answers, 'systems_assessed_other' %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'species_groups_assessed') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :string, label: 'Species groups assessed' %>
      <% end %>
    </section>
    <section id="ecosystem_services">
      <h1>Ecosystem services/functions assessed</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'provisioning') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :check_boxes, label: 'Provisioning', collection: ['Food', 'Water', 'Timber/fibres', 'Genetic resources', 'Medicinal resources', 'Ornamental resources', 'Energy/fuel'], input_html: { class: false }, checked: answer_object(@assessment, 'provisioning').text_value.try(:split, ',') %>
      <% end %>

      <div id="provisioning_others">
        <%= f.simple_fields_for :answers, answer_objects(@assessment, 'provisioning_other') do |builder| %>
          <%= render 'nested_field_form', :f => builder %>
        <% end %>
      </div>

      <%= link_to_add_fields 'Add Answer', f, :answers, 'provisioning_other' %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'regulating') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :check_boxes, label: 'Regulating', collection: ['Air quality', 'Climate regulation', 'Moderation of extreme events', 'Regulation of water flows', 'Regulation of water quality', 'Waste treatment', 'Erosion prevention', 'Pollination', 'Pest and disease control'], input_html: { class: false }, checked: answer_object(@assessment, 'regulating').text_value.try(:split, ',') %>
      <% end %>

      <div id="regulating_others">
        <%= f.simple_fields_for :answers, answer_objects(@assessment, 'regulating_other') do |builder| %>
          <%= render 'nested_field_form', :f => builder %>
        <% end %>
      </div>

      <%= link_to_add_fields 'Add Answer', f, :answers, 'regulating_other' %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'supporting') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :check_boxes, label: 'Supporting Services/Functions', collection: ['Habitat maintenance', 'Nutrient cycling', 'Soil formation and fertility', 'Primary production'], input_html: { class: false }, checked: answer_object(@assessment, 'supporting').text_value.try(:split, ',') %>
      <% end %>

      <div id="supporting_others">
        <%= f.simple_fields_for :answers, answer_objects(@assessment, 'supporting_other') do |builder| %>
          <%= render 'nested_field_form', :f => builder %>
        <% end %>
      </div>

      <%= link_to_add_fields 'Add Answer', f, :answers, 'supporting_other' %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'cultural_services') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :check_boxes, label: 'Cultural Services', collection: ['Recreation and tourism', 'Spiritual, inspiration and cognitive development'], input_html: { class: false }, checked: answer_object(@assessment, 'cultural_services').text_value.try(:split, ',') %>
      <% end %>

      <div id="cultural_services_others">
        <%= f.simple_fields_for :answers, answer_objects(@assessment, 'cultural_services_other') do |builder| %>
          <%= render 'nested_field_form', :f => builder %>
        <% end %>
      </div>

      <%= link_to_add_fields 'Add Answer', f, :answers, 'cultural_services_other' %>

      <h2>Scope of assessment includes</h2>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'scope_drivers_of_change') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :radio_buttons, label: 'Drivers of change in systems and services', input_html: { class: false } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'scope_impacts_of_change') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :radio_buttons, label: 'Impacts of change in services on human well-being', input_html: { class: false } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'scope_options_for_responding') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :radio_buttons, label: 'Options for responding/interventions to the trends observed', input_html: { class: false } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'scope_explicit_consideration') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :radio_buttons, label: 'Explicit consideration of the role of biodiversity in the systems and services covered by the assessment', input_html: { class: false } %>
      <% end %>
    </section>
    <section id="timing">
      <h1>Timing of the assessment</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'year_started') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :select, label: 'Year assessment started', collection: (2001..(Time.now.year + 2)).to_a.prepend('Pre 2000'), input_html: { class: 'select2 span8' } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'year_finished') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :select, label: 'Year assessment finished', collection: (2001..(Time.now.year + 2)).to_a.prepend('Pre 2000').append('Ongoing'), input_html: { class: 'select2 span8' } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'anticipated_to_finish') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :select, label: 'If ongoing, year assessment is anticipated to finish', collection: Time.now.year..2020, input_html: { class: 'select2 span8' } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'periodicity') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :radio_buttons, label: 'Periodicity of assessment', collection: ['One off', 'Repeated'], input_html: { class: false } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'how_frequently') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :string, label: 'If repeated, how frequently' %>
      <% end %>
    </section>
    <section id="outputs">
      <h1>Assessment outputs</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'websites') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Website(s)' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'reports') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Report(s)' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'communication_materials') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Communication materials (e.g. brochure, presentations, posters, audio-visual media)' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'journal_publications') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Journal publications' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'training_materials') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Training materials' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'other_documents') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Other documents/outputs' %>
      <% end %>
    </section>
    <section id="tools_and_processes">
      <h1>Tools and processes</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'tools_and_approaches') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :check_boxes, label: 'Tools and approaches used in the assessment', collection: ['Modelling', 'Trade-off analysis', 'Geospatial analysis', 'Indicators', 'Scenarios', 'Economic valuation', 'Social (non-monetary) valuation'], input_html: { class: false }, checked: answer_object(@assessment, 'tools_and_approaches').text_value.try(:split, ',') %>
      <% end %>

      <div id="tools_and_approaches_others">
        <%= f.simple_fields_for :answers, answer_objects(@assessment, 'tools_and_approaches_other') do |builder| %>
          <%= render 'nested_field_form', :f => builder %>
        <% end %>
      </div>

      <%= link_to_add_fields 'Add Answer', f, :answers, 'tools_and_approaches_other' %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'process_used_for_stakeholder') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Process used for stakeholder engagement in the assessment process and which component' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'key_stakeholder') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Key stakeholder groups engaged' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'number_of_people') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :select, label: 'The number of people directly involved in the assessment process', collection: ['Less than 10', '10-100', '100-1000', 'More than 1000'], input_html: { class: 'select2 span8' } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'incorporation_of_knowledge') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :check_boxes, label: 'Incorporation of scientific and other types of knowledge', collection: ['Scientific information only', 'Resource experts (e.g. foresters etc)', 'Traditional/local knowledge', 'Citizen science', 'Other (please specify)'], input_html: { class: false }, checked: answer_object(@assessment, 'incorporation_of_knowledge').text_value.try(:split, ',') %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'supporting_documentation') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Supporting documentation for specific approaches, methodology or criteria developed and/or used to integrate knowledge systems into the assessment' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'reports_peer') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :radio_buttons, label: 'Assessment reports peer reviewed', input_html: { class: false } %>
      <% end %>
    </section>
    <section id="data">
      <h1>Data</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'accessibility_of_data') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Accessibility of data used in assessment' %>
      <% end %>
    </section>
    <section id="policy_impact">
      <h1>Policy Impact</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'impacts') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Impacts the assessment has had on policy and/or decision making, as evidenced through policy references and actions' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'review_on_policy') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :radio_buttons, label: 'Independent or other review on policy impact of the assessment', input_html: { class: false } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'lessons_learnt') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Lessons learnt for future assessments from these reviews' %>
      <% end %>
    </section>
    <section id="capacity_building">
      <h1>Capacity-building</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'capacity_building_needs') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Capacity building needs idenfified during the assessment' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'actions_taken_build_capacity') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, as: :select, label: 'Actions taken by the assessment to build capacity', collection: ['Fellowships/exchanges/secondments/mentoring programmes', 'Network and sharing experiences', 'Access to funding', 'Sharing of data/repatriation of data', 'Workshops', 'Developing/promoting and providing access to support tools', 'Formal training', 'Communication and awareness raising', 'Other (please specify)'], input_html: { class: 'select2 span8' } %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'gaps_in_capacity') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'How have gaps in capacity been communicated to the different stakeholders' %>
      <% end %>
    </section>
    <section id="knowledge_generation">
      <h1>Knowledge generation</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'gaps_in_knowledge') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Gaps in knowledge identified from the assessment' %>
      <% end %>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'gaps_in_knowledge_communicated') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'How gaps in knowledge have been communicated to the different stakeholders' %>
      <% end %>
    </section>
    <section id="additional_information">
      <h1>Additional information</h1>

      <%= f.simple_fields_for :answers, answer_object(@assessment, 'additional_information') do |builder| %>
        <%= builder.input :answer_type, as: :hidden %>
        <%= builder.input :text_value, label: 'Additional relevant information' %>
      <% end %>
    </section>
    <section id="contact">
      <h1>Contact</h1>
    </section>
    <section id="note">
      <h1>Note</h1>

      <%= f.input :note %>
      <%= f.input :ready_to_publish, input_html: { class: false } %>
    </section>

    <% if current_user.admin? %>
      <section id="administration">
        <h1>Administration</h1>
        
        <%= f.input :published, input_html: { class: false } %>
        <%= f.association :editor %>
      </section>
    <% end %>
  </div>

  <div class="form-actions">
    <%= f.button :submit, :class => "btn-primary" %>
  </div>
<% end %>
